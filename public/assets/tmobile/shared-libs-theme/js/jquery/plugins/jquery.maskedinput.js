(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(e){var d=navigator.userAgent,c=/iphone/i.test(d),a=/chrome/i.test(d),b=/android/i.test(d),f;e.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},autoclear:true,dataName:"rawMaskFn",placeholder:"_"};e.fn.extend({caret:function(i,g){var h;if(this.length===0||this.is(":hidden")||this.get(0)!==document.activeElement){return}if(typeof i=="number"){g=(typeof g==="number")?g:i;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(i,g)}else{if(this.createTextRange){h=this.createTextRange();h.collapse(true);h.moveEnd("character",g);h.moveStart("character",i);h.select()}}})}else{if(this[0].setSelectionRange){i=this[0].selectionStart;g=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){h=document.selection.createRange();i=0-h.duplicate().moveStart("character",-100000);g=i+h.text.length}}return{begin:i,end:g}}},unmask:function(){return this.trigger("unmask")},mask:function(q,j){var n,k,h,i,p,g,l,o;if(!q&&this.length>0){n=e(this[0]);var m=n.data(e.mask.dataName);return m?m():undefined}j=e.extend({autoclear:e.mask.autoclear,placeholder:e.mask.placeholder,completed:null},j);k=e.mask.definitions;h=[];i=l=q.length;p=null;q=String(q);e.each(q.split(""),function(r,s){if(s=="?"){l--;i=r}else{if(k[s]){h.push(new RegExp(k[s]));if(p===null){p=h.length-1}if(r<i){g=h.length-1}}else{h.push(null)}}});return this.trigger("unmask").each(function(){var B=e(this),E=e.map(q.split(""),function(K,J){if(K!="?"){return k[K]?I(J):K}}),y=E.join(""),w=B.val();function D(){if(!j.completed){return}for(var J=p;J<=g;J++){if(h[J]&&E[J]===I(J)){return}}j.completed.call(B)}function I(J){if(J<j.placeholder.length){return j.placeholder.charAt(J)}return j.placeholder.charAt(0)}function u(J){while(++J<l&&!h[J]){}return J}function t(J){while(--J>=0&&!h[J]){}return J}function x(M,J){var L,K;if(M<0){return}for(L=M,K=u(J);L<l;L++){if(h[L]){if(K<l&&h[L].test(E[K])){E[L]=E[K];E[K]=I(K)}else{break}K=u(K)}}A();B.caret(Math.max(p,M))}function s(N){var L,M,J,K;for(L=N,M=I(N);L<l;L++){if(h[L]){J=u(L);K=E[L];E[L]=M;if(J<l&&h[J].test(K)){M=K}else{break}}}}function G(M){var K=B.val();var N=B.caret();if(o&&o.length&&o.length>K.length){z(true);while(N.begin>0&&!h[N.begin-1]){N.begin--}if(N.begin===0){while(N.begin<p&&!h[N.begin]){N.begin++}}B.caret(N.begin,N.begin)}else{var J=z(true);var L=K.charAt(N.begin);if(N.begin<l){if(!h[N.begin]){N.begin++;if(h[N.begin].test(L)){N.begin++}}else{if(h[N.begin].test(L)){N.begin++}}}B.caret(N.begin,N.begin)}D()}function C(J){z();if(B.val()!=w){B.change()}}function v(N){if(B.prop("readonly")){return}var L=N.which||N.keyCode,O,M,K;o=B.val();if(L===8||L===46||(c&&L===127)){O=B.caret();M=O.begin;K=O.end;if(K-M===0){M=L!==46?t(M):(K=u(M-1));K=L===46?u(K):K}r(M,K);x(M,K-1);N.preventDefault()}else{if(L===13){C.call(this,N)}else{if(L===27){B.val(w);B.caret(0,z());N.preventDefault()}else{if(L>=37&&L<=40){var J=jQuery.Event("keypress");J.which=L;B.trigger(J);return}else{if(L>=37&&L<=40){var J=jQuery.Event("keypress");J.which=L;B.trigger(J);return}}}}}}function F(N){if(B.prop("readonly")){return}var J=N.which||N.keyCode,P=B.caret(),M,O,L;if(N.ctrlKey||N.altKey||N.metaKey||J<32){return}else{if(J>=37&&J<=40){return}else{if(J>=112&&J<=123){return}else{if(J&&J!==13){if(P.end-P.begin!==0){r(P.begin,P.end);x(P.begin,P.end-1)}M=u(P.begin-1);if(M<l){O=String.fromCharCode(J);if(h[M].test(O)){s(M);E[M]=O;A();L=u(M);if(b){var K=function(){e.proxy(e.fn.caret,B,L)()};setTimeout(K,0)}else{B.caret(L)}if(P.begin<=g){D()}}}N.preventDefault()}}}}}function H(L){var J=B.caret().begin,K=z();if(J>=K){B.caret(K)}else{B.caret(J)}if(B.val()!=w){B.change()}}function r(L,J){var K;for(K=L;K<J&&K<l;K++){if(h[K]){E[K]=I(K)}}}function A(){B.val(E.join(""))}function z(K){var O=B.val(),N=-1,J,M,L;for(J=0,L=0;J<l;J++){if(h[J]){E[J]=I(J);while(L++<O.length){M=O.charAt(L-1);if(h[J].test(M)){E[J]=M;N=J;break}}if(L>O.length){r(J+1,l);break}}else{if(E[J]===O.charAt(L)){L++}if(J<i){N=J}}}if(K){A()}else{if(N+1<i){if(j.autoclear||E.join("")===y){if(B.val()){B.val("")}r(0,l)}else{A()}}else{A();B.val(B.val().substring(0,N+1))}}return(i?J:p)}B.data(e.mask.dataName,function(){return e.map(E,function(K,J){return h[J]&&K!=I(J)?K:null}).join("")});B.one("unmask",function(){B.off(".mask").removeData(e.mask.dataName)}).on("focus.mask",function(){if(B.prop("readonly")){return}clearTimeout(f);var J;w=B.val();J=z();f=setTimeout(function(){if(B.get(0)!==document.activeElement){return}A();if(J==q.replace("?","").length){B.caret(0,J)}else{B.caret(J)}},10)}).on("blur.mask",C).on("keydown.mask",v).on("keypress.mask",F).on("keyup.mask",H).on("input.mask paste.mask",function(){if(B.prop("readonly")){return}setTimeout(function(){var J=z(true);B.caret(J);D()},0)});if(a&&b){B.off("input.mask").on("input.mask",G)}z()})}})}));